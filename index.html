<!doctype html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Creds UI">
    <title>Creds UI</title>

    <!-- <link rel="stylesheet" href="css/pure-min.css"> -->
    <link rel="stylesheet" href="css/custom.css">
    <script src="js/vue.js"></script>
</head>
<body>
  <div id="app">
      <div v-if="page === 'login'">
          <form v-on:submit.prevent="login()">
              <fieldset>
                  <legend>Please login</legend>

                  <label>Username
                      <input
                          type="text"
                          name="username"
                          placeholder="Username…"
                          value="foo"
                          ref="loginInputUsername" />
                  </label>

                  <label for="password">
                      <input type="password" value="bar" />
                  </label>

                  <button type="submit">Login</button>
              </fieldset>
          </form>
      </div>

      <div v-show="page === 'list'">
          <select-list v-on:show-list-entry="showListEntry"></select-list>
      </div>

      <div v-if="page === 'entry'">
          This is the list entry
          {{ selectedListEntry.id }}: {{ selectedListEntry.title }}
          <button v-on:click="backToList()">back</button>
      </div>

      <div v-if="page === 'add'">
        <form>
            <fieldset>
                <legend>Add entry</legend>

                <label>Username
                    <input type="text" name="username" v-model="add.username" />
                </label>

                <label>Password
                    <input type="password" name="password" v-model="add.password" />
                </label>

                <label>Repeat password
                    <input type="password" name="password_repeat" v-model="add.passwordRepeat" />
                </label>

                <button type="button" v-on:click.prevent="addEntry()">add</button>
            </fieldset>
        </form>
      </div>

      <div v-if="page !== 'login'">
          <button v-on:click="logout()">logout</button>
      </div>
  </div>

  <script src="js/my.js"></script>
  <script src="js/my.selectlist.js"></script>

    <script type="text/x-template" id="select-list-tpl">
        <div>
            <input
                v-on:keydown.down.prevent="selectNext"
                v-on:keydown.up.prevent="selectPrev"
                v-on:keyup.enter="$emit('show-list-entry', list.getCurrent())"
                tabindex="1" />

          <ul>
              <li v-for="listEntry in list.entries"
                  v-bind:key="listEntry.id"
                  v-bind:class="{ selected: listEntry.selected }"
                  v-on:click="$emit('show-list-entry', listEntry)">
                  {{ listEntry.title }}
              </li>
          </ul>
      </div>
    </script>

    <script>
    Vue.component('select-list', {
        template: '#select-list-tpl',
        data: function() {
            return {
                list: My.SelectList([
                    { id: 1, title: '500 pieces of paper', selected: false},
                    { id: 2, title: 'One pair of scissors', selected: false},
                    { id: 3, title: 'A bottle of beer', selected: false},
                    { id: 4, title: 'Some kind of well-designed notebook', selected: false},
                    { id: 5, title: 'A handful of beautiful trees', selected: false}
                ])
            };
        },
        mounted: function() {
            /// …
        },
        methods: {
            selectNext: function(event) {
                this.list.selectNext();
            },
            selectPrev: function(event) {
                this.list.selectPrev();
            }
        }
    })
    </script>

    <script>
        var app = new Vue({
            el: '#app',
            data: {
                page: 'add',
                selectedListEntry: null,
                add: {
                  username: null,
                  password: null,
                  passwordRepeat: null
                }
            },
            mounted: function () {
                if (this.page === 'login') {
                    this.$refs.loginInputUsername.focus();
                }
            },
            methods: {
                login: function() {
                    this.page = 'list';
                },
                logout: function() {
                    this.page = 'login';
                },
                addEntry: function() {
                    console.log(
                      'Adding an entry...',
                      this.add.username,
                      this.add.password,
                      this.add.passwordRepeat
                    );
                },
                showListEntry: function(selectedListEntry) {
                    this.selectedListEntry = selectedListEntry;
                    this.page = 'entry';
                },
                backToList: function() {
                    this.page = 'list';
                }
            }
        })
    </script>
</body>
</html>
