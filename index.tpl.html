<!doctype html>
<html lang="de">
<head>
[[head.html]]
</head>

<body>
    <div id="app">
        [[app.html]]
    </div>

[[samples.html]]
[[module.my.html]]
[[module.my.selectlist.html]]
[[module.my.encryptor.html]]

<script>
    var api_key = null;
    var encryptor = My.Encryptor();
    encryptor.setPassword('Johns Encryption Phrase');

    var getCreds = function(api_key) {
        axios.get(My.config.api.base_url + My.config.routes.creds, {
            headers: {'Authorization': 'Bearer ' + api_key},
        })
        .then(function (response) {
            var entries = response.data.data;
            for (var i = 0; i < entries.length; i += 1) {
                var id = entries[i].id;
                var cred_item = entries[i].cred_item;
                console.log(id);
                console.log(JSON.parse(encryptor.decrypt(cred_item)));
            }
        })
        .catch(function (error) {
            console.log(error);
        });
    }

    var postCred = function(api_key) {
        axios.post(My.config.api.base_url + My.config.routes.creds, {
            'cred_item': encryptor.encrypt(JSON.stringify(samples[8]))
        }, {
            headers: {'Authorization': 'Bearer ' + api_key},
        })
        .then(function (response) {
            console.log(response);
        })
        .catch(function (error) {
            console.log(error);
        });
    }

    axios.post(My.config.api.base_url + My.config.routes.login, {
        username: 'John Doe',
        password: 'Johns Secret Password'
    })
    .then(function (response) {
        api_key = response.data;
        getCreds(api_key);
    })
    .catch(function (error) {
        console.log(error);
    });

</script>

[[component.login.html]]
[[component.select_list.html]]
[[component.add_entry.html]]
[[component.list_entry.html]]

[[app.js.html]]
</body>
</html>
