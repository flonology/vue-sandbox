<script type="text/x-template" id="login-tpl">
    <form v-on:submit.prevent="login()">
        {{ errorMessage }}

        <fieldset>
            <legend>Please login</legend>

            <label class="form__label">Username
                <input
                    class="form__input"
                    type="text"
                    v-model="username"
                    ref="loginInputUsername" />
            </label>

            <label class="form__label">Password
                <input
                    class="form__input"
                    type="password"
                    v-model="password" />
            </label>

            <button class="button" type="submit" ref="loginSubmitButton">Login</button>
        </fieldset>
    </form>
</script>


<script>
    Vue.component('login', {
        template: '#login-tpl',
        props: ['api'],
        data: function() {
            return {
                username: 'John Doe',
                password: 'Johns Secret Password',
                errorMessage: 'Will click login button shortlyâ€¦'
            };
        },
        mounted: function() {
            var self = this;
            this.$refs.loginInputUsername.focus();

            setTimeout(function() {
                self.$refs.loginSubmitButton.click();
            }, 1000);
        },
        methods: {
            login: function() {
                var self = this;

                this.api.login(this.username, this.password, function() {
                    self.$emit('logged-in');
                }, function() {
                    self.errorMessage = 'Login failed.';
                });
            }
        }
    });
</script>
